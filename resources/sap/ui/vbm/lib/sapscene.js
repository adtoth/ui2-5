 
VBI.SceneManager=function(){var s={};s.vbiclass="SceneManager";s.m_SceneArray=[];s.find=function(n){for(var a=0;a<s.m_SceneArray.length;++a)if(s.m_SceneArray[a].id==n)return s.m_SceneArray[a];return null};s.clear=function(){for(var n=0;n<s.m_SceneArray.length;++n)s.m_SceneArray[n].clear();s.m_SceneArray=[]};s.load=function(d,c){if(d.Set){var a;if(jQuery.type(d.Set)=='object'){if(d.Set.name){if(a=s.find(d.Set.name)){if(d.Set.SceneGeo)a.load(d.Set.SceneGeo,c);else a.load(d.Set.Scene,c);return}}else{s.clear()}if(d.Set.SceneGeo){if(jQuery.type(d.Set.SceneGeo)=='object'){var a=new VBI.GeoScene(null,null,null);a.load(d.Set.SceneGeo,c);s.Add(a)}else if(jQuery.type(d.Set.SceneGeo)=='array'){for(var n=0;n<d.Set.SceneGeo.length;++n){var a=new VBI.GeoScene(null,null,null);a.load(d.Set.SceneGeo[n],c);s.Add(a)}}}else if(d.Set.Scene&&jQuery.type(d.Set.Scene)=='object'){if(jQuery.type(d.Set.Scene)=='object'){var a=new VBI.Scene(null,null,null);a.load(d.Set.Scene,c);s.Add(a)}else if(jQuery.type(d.Set.Scene)=='array'){for(var n=0;n<d.Set.Scene.length;++n){var a=new VBI.Scene(null,null,null);a.load(d.Set.Scene[n],c);s.Add(a)}}VBI.m_bTrace&&VBI.Trace("ERROR: non geo  scenes are not yet supported")}}else if(jQuery.type(d.Set)=='array'){}}};s.Add=function(a){s.m_SceneArray.push(a)};s.GetScene=function(t){for(var i=0;i<s.m_SceneArray.length;++i){if(s.m_SceneArray[i].m_TargetName==t)return s.m_SceneArray[i]}return null};s.GetSceneByName=function(n){for(var i=0;i<s.m_SceneArray.length;++i){if(s.m_SceneArray[i].m_ID==n)return s.m_SceneArray[i]}return null};return s};
VBI.Scene=function(t){var s={};s.vbiclass="Scene";s.m_TargetName=t;s.m_ID="";s.m_Ctx=null;s.m_Div=null;s.m_DivCopyright=null;s.m_CaptureVO=null;s.m_VOS=[];s.m_nCanvasXOversize=2;s.m_nCanvasYOversize=2;s.m_nCanvasStdXPos=s.m_nCanvasXOversize/4;s.m_nCanvasStdYPos=s.m_nCanvasYOversize/4;s.m_nOverzoom=0.0;s.m_nMapMovePreLoad=120;s.m_nTicksInALod=5;s.m_nLodFactorZoomIn=Math.pow(2,1/s.m_nTicksInALod);s.m_nLodFactorZoomOut=1/s.m_nLodFactorZoomIn;s.m_Target=t;s.load=function(d,c){s.m_Ctx=c;if(d.id)s.m_ID=d.id};s.clear=function(){};s.Render=function(){};s.Awake=function(t){};s.NotifyDataChange=function(){for(var n=0;n<s.m_VOS.length;++n)s.m_VOS[n].NotifyDataChange(s.m_Ctx)};s.GetPosFromPoint=function(p){return p};s.SetCapture=function(v){m_CaptureVO=v};s.DispatchEvent=function(e){var f;e.m_Scene=s;if(e.offsetX==undefined||e.offsetY==undefined){if(e.clientX!==undefined&&e.clientY!==undefined){var r=e.target.getBoundingClientRect();e.offsetX=e.clientX-r.left;e.offsetY=e.clientY-r.top}}if(s.m_CaptureVO){if((f=s.m_CaptureVO["on"+e.type])&&typeof(f)=='function'){if((f.bind(m_CaptureVO))(e)==true)return true}}var i;for(var n=0;n<s.m_VOS.length;++n){i=s.m_VOS.length-n-1;if((f=s.m_VOS[i]["on"+e.type])&&typeof(f)=='function'){if((f.bind(s.m_VOS[i]))(e)==true)return true}}return false};return s};
VBI.GeoScene=function(t,m,c){var s=new VBI.Scene(t);s.vbiclass="GeoScene";s.m_RefMapLayerStack="";s.m_UCS=[0.0,0.0,0.0];s.m_Canvas=[];s.m_ZoomFactors=[1.0,1.0];s.m_MapManager=m;s.m_MapLayerStack=c;s.m_bIsIDevice=(/iphone|ipad/gi).test(navigator.appVersion);s.m_bIsAndroid=(/android/gi).test(navigator.appVersion);s.Click=null;s.m_nOverlayIndex=2;s.m_nTapCount=0;var d=null;s.GetHomeLocation=null;s.m_currentMouseX=0;s.m_currentMouseY=0;s.m_oldMouseX=0;s.m_oldMouseY=0;s.m_currentMouseDownX=0;s.m_currentMouseDownY=0;s.m_midPointX=0;s.m_midPointY=0;s.m_currentTouchDistance=0;s.m_bMove=false;s.m_bZoom=false;s.m_bTwoFingerTap=false;s.m_bAnimZoomDone=false;s.m_BlendTimer=null;s.m_startPointLonLat=[0.0,0.0];s.m_startLOD=0;s.m_bNavControlVisible=true;s.m_NavControl=null;s.m_RenderTimer=null;s.m_SuppressedNavigation={zoom:false,move:false};s.m_bScaleVisible=true;s.m_OverlayImageData=null;s.onTileLoaded=null;s.clear=function(){for(var n=0;n<s.m_VOS.length;++n)s.m_VOS[n].clear();s.m_VOS=[];if(s.m_NavControl)s.m_NavControl.clear();s.Remove();s.m_Ctx=null;s.m_RefMapLayerStack="";s.m_MapManager=null;s.m_MapLayerStack=null;s.m_TargetName=null;s.m_NavControl=null;s.m_OverlayImageData=null;s.m_DivCopyright=null;s.m_Div=null;s.m_Target=null};s.load=function(a,b){s.m_Ctx=b;if(a.id)s.m_ID=a.id;if(a.refMapLayerStack)s.m_RefMapLayerStack=b.m_MapLayerStackManager.GetMapLayerStack(a.refMapLayerStack);else VBI.m_bTrace&&VBI.Trace("no map layer specified in geo scene");if(a.VO){var v=new VBI.VisualObjects();if(jQuery.type(a.VO)=='object'){var e=v.Factory.CreateInstance(a.VO.type);e.load(a.VO,b);e.m_Scene=s;s.m_VOS.push(e)}else if(jQuery.type(a.VO)=='array'){for(var n=0;n<a.VO.length;++n){if(jQuery.type(a.VO[n])=='object'){var e=v.Factory.CreateInstance(a.VO[n].type);e.load(a.VO[n],b);e.m_Scene=s;s.m_VOS.push(e)}}}}if(a.initialStartPosition){var f=a.initialStartPosition.split(';');s.m_startPointLonLat=VBI.MathLib.DegToRad([parseFloat(f[0]),parseFloat(f[1])])}if(a.initialZoom){s.m_startLOD=parseInt(a.initialZoom)}var p=/[1ty]/i;var S={zoom:false,move:false,fade:false};if(a.NavigationDisablement){if(a.NavigationDisablement.zoom)s.m_SuppressedNavigation.zoom=p.test(a.NavigationDisablement.zoom);if(a.NavigationDisablement.move)s.m_SuppressedNavigation.move=p.test(a.NavigationDisablement.move)}if(s.m_bIsIDevice||s.m_bIsAndroid){s.m_bNavControlVisible=false}else{S.zoom=s.m_SuppressedNavigation.zoom;S.move=s.m_SuppressedNavigation.move;if(s.m_SuppressedNavigation.zoom&&s.m_SuppressedNavigation.move)s.m_bNavControlVisible=false;else{if(a.navControlVisible)s.m_bNavControlVisible=p.test(a.navControlVisible);if(s.m_bNavControlVisible){if(a.SuppressedNavControlVisibility){if(!S.zoom&&a.SuppressedNavControlVisibility.zoom)S.zoom=p.test(a.SuppressedNavControlVisibility.zoom);if(!S.move&&a.SuppressedNavControlVisibility.move)S.move=p.test(a.SuppressedNavControlVisibility.move);if(a.SuppressedNavControlVisibility.fade)S.fade=p.test(a.SuppressedNavControlVisibility.fade)}if(S.move&&S.zoom)s.m_bNavControlVisible=false}}}if(s.m_bNavControlVisible)s.m_NavControl=new VBI.NavigationControl(S);if(a.scaleVisible)s.m_bScaleVisible=p.test(a.scaleVisible);if(s.m_bScaleVisible)s.m_Scale=new VBI.Scale(s)};s.SetToolTip=function(a){var C=s.m_Canvas[s.m_nOverlayIndex];if(C.title!=a)C.title=a};s.SetCursor=function(a){var C=s.m_Canvas[s.m_nOverlayIndex];if(C.style.cursor!=a)C.style.cursor=a};s.RenderAsync=function(){if(s.m_RenderTimer!=null)window.clearInterval(s.m_RenderTimer);s.m_RenderTimer=window.setInterval(s.Render,20)};s.Render=function(){if(s.m_RenderTimer){window.clearInterval(s.m_RenderTimer);s.m_RenderTimer=null}s.InternalRenderLayer(s.m_Canvas[s.m_nOverlayIndex],false)};s.GoToInitialStart=function(){s.ZoomToGeoPosition(s.m_startPointLonLat,s.m_startLOD)};s.ZoomToMultiplePositions=function(l,e){var f=[];var g=[];if(l.length!=e.length)return;for(var n=0;n<l.length;n++){var L=(parseFloat(l[n]));if(L<0)L+=360;f.push(L);g.push(parseFloat(e[n]))}if(f.length!=g.length||!f.length)return;f.sort(function(a,b){return a-b});g.sort(function(a,b){return a-b});var i,j,k,o;k=g[0];o=g[g.length-1];var p,q,r,u;q=f[f.length-1];for(var n=0;n<f.length;n++){r=f[n];u=(r<q?(r+360-q):(r-q));if(p==undefined||u>p){p=u;i=(r<q?r+360:r);j=q}q=r}var v=14;var w=14;if(o!=k){v=180/(o-k);v=Math.log(v)*Math.LOG2E}if(j!=i){if(j<i)j+=360;w=360/(j-i);w=Math.log(w)*Math.LOG2E}var z=i+(j-i)/2;if(z>180)z=z-360;var x=k+(o-k)/2;s.ZoomToGeoPosition(VBI.MathLib.DegToRad([z,x]),w<v?w:v)};s.ZoomToGeoPosition=function(l,a){var n=0;var b=0;var p=false;var e=Math.max(a,s.GetMinLOD());if(e!=a){a=Math.floor(e);p=(a!=e)}var r=s.m_Div.getBoundingClientRect();n=r.width;b=r.height;var f=(1<<a)*s.m_MapManager.m_tileWidth;var g=(1<<a)*s.m_MapManager.m_tileHeight;var u=[f,g];VBI.MathLib.LonLatToUCS(l,u);u[1]=g-u[1];var L=(u[0]-n/2.0)/s.m_MapManager.m_tileWidth;var T=(u[1]-b/2.0)/s.m_MapManager.m_tileHeight;var i=Math.floor(L-s.m_nCanvasStdXPos);var j=Math.floor(T-s.m_nCanvasStdYPos);var k=Math.floor((u[0]-n/2)-i*s.m_MapManager.m_tileWidth);var o=Math.floor((u[1]-b/2)-j*s.m_MapManager.m_tileHeight);var q=s.m_nTilesX*s.m_MapManager.m_tileWidth;var v=s.m_nTilesY*s.m_MapManager.m_tileHeight;var w=s.m_Canvas[0];s.MoveCanvas(w,-k,-o,q,v);var x=w.getContext("2d");x.clearRect(0,0,w.width,w.height);x=s.m_Canvas[1].getContext("2d");x.clearRect(0,0,w.width,w.height);s.m_MapManager.RequestTiles(w,s.m_MapLayerStack,i,j,s.m_nTilesX,s.m_nTilesY,0,0,0,0,parseInt(a),false);w.m_nExactLOD=w.m_nCurrentLOD+Math.log(w.getPixelWidth()/(256*s.m_nTilesX))*Math.LOG2E;if(p)s.ZoomMap(0,s.m_Div.clientWidth/2+k,s.m_Div.clientHeight/2+o);else{s.InternalRenderLayer(s.m_Canvas[s.m_nOverlayIndex],false);if(s.m_bNavControlVisible&&s.m_NavControl)s.m_NavControl.AdjustScrollPoint(a)}};s.SetMapLayerStack=function(n){var i=VBI.GetMapLayerStack(n);if(i==null)return;s.m_MapLayerStack=i;var a=s.m_Canvas[0];s.m_MapManager.RequestTiles(a,s.m_MapLayerStack,a.m_nCurrentX,a.m_nCurrentY,s.m_nTilesX,s.m_nTilesY,0,0,0,0,a.m_nCurrentLOD,false);s.InternalRenderLayer(s.m_Canvas[s.m_nOverlayIndex],false)};s.ZoomToZoomlevel=function(a,l,n){var b=Math.pow(2,n-a.m_nExactLOD);s.ZoomMap(b,s.m_Div.clientWidth/2-a.getPixelLeft(),s.m_Div.clientHeight/2-a.getPixelTop())};s.GetMapLayerStack=function(){return s.m_MapLayerStack};s.GetMinLOD=function(){var n=s.m_Div.clientWidth/s.m_MapManager.m_tileWidth;var a=Math.log(n)*Math.LOG2E;return Math.max(a,s.m_MapLayerStack.GetMinLOD())};s.GetMaxLOD=function(){return s.m_MapLayerStack.GetMaxLOD()};s.GetCurrentZoomlevel=function(){var f=s.m_Canvas[0].getPixelWidth()/s.m_nWidthCanvas;var z=Math.log(f)/Math.LN2+s.m_Canvas[0].m_nCurrentLOD;return z};s.GetCenterPos=function(){var a=s.getCanvas();var r=s.m_Div.getBoundingClientRect();var p=[r.width/2-a.getPixelLeft(),r.height/2-a.getPixelTop()];return s.GetGeoFromPoint(p)};s.GetPosFromPoint=function(p){return s.GetGeoFromPoint(p)};s.GetEventVPCoords=function(e){var r=s.m_Div.getBoundingClientRect();return[e.clientX-r.left,e.clientY-r.top]};s.GetEventVPCoordsObj=function(e){var p=s.GetEventVPCoords(e);return{x:p[0].toString(),y:p[1].toString()}};s.SetMoveMode=function(S){if(S){document.addEventListener('mouseup',s.processmouseup,true);document.addEventListener('mousemove',s.processmousemove,true)}else{s.m_bMove=false;s.m_currentMouseX=0;s.m_currentMouseY=0;document.removeEventListener('mouseup',s.processmouseup,true);document.removeEventListener('mousemove',s.processmousemove,true)}};s.InternalRenderVisualObjects=function(a,b){var v=s.m_VOS;for(var n=0;n<s.m_VOS.length;++n)v[n].Render(a,b)};s.InternalRenderLayer=function(a,C){s.m_OverlayImageData=null;var o=a.getPixelWidth();var b=a.getPixelHeight();a.setPixelWidth(s.m_nWidthCanvas);a.setPixelHeight(s.m_nHeightCanvas);s.m_ZoomFactors[0]=o/s.m_nWidthCanvas;s.m_ZoomFactors[1]=b/s.m_nHeightCanvas;var e=a.getContext('2d');if(C){e.clearRect(0,0,a.width,a.height);a.setPixelWidth(o);a.setPixelHeight(b);return}e.clearRect(0,0,a.width,a.height);s.InternalRenderVisualObjects(a,e);a.setPixelWidth(o);a.setPixelHeight(b);s.InternalOnRenderLayer(a)};s.InternalOnMoveLayer=function(a){s.m_Ctx.onMoveLayer(a)};s.InternalOnZoomLayer=function(a){s.m_Ctx.onZoomLayer(a)};s.InternalOnRenderLayer=function(a){s.m_Ctx.onRenderLayer(a);if(s.GetHomeLocation){var o=a.getPixelWidth();var b=a.getPixelHeight();var l=[0,0];var e=s.GetHomeLocation();l[0]=e[0];l[1]=e[1];var x=s.GetPointFromGeo(l);a.setPixelWidth(s.m_nWidthCanvas);a.setPixelHeight(s.m_nHeightCanvas);var f=a.getContext('2d');f.clearRect(0,0,a.width,a.height);f.fillStyle='yellow';f.beginPath();f.arc(x[0],x[1],5,0,Math.PI*2,true);f.closePath();f.fill();var i=null;if(s.m_Ctx)i=s.m_Ctx.GetImage("dummy",s.RenderAsync.bind(s));if(i)f.drawImage(i,x[0]-i.naturalWidth/2,x[1]-i.naturalHeight);a.setPixelWidth(o);a.setPixelHeight(b)}};if(!s.m_bIsIDevice&&!s.m_bIsAndroid){s.processmousedown=function(e){if(s.DispatchEvent(e)==true)return;VBI.m_bTrace&&VBI.Trace("processmousedown");if(!s.m_SuppressedNavigation.move){s.m_bMove=true;s.m_currentMouseX=e.clientX;s.m_currentMouseY=e.clientY;s.m_currentMouseDownX=e.clientX;s.m_currentMouseDownY=e.clientY;s.SetMoveMode(true)}};s.processcontextmenu=function(e){if(s.DispatchEvent(e)==true)return;var a,b=s.m_Ctx.m_Actions;if(b){if(a=b.findAction("ContextMenu",s,"Map"))s.m_Ctx.FireAction(a,s,"Map",null,s.GetEventVPCoordsObj(e));e.preventDefault()}};s.processmouseout=function(e){if(s.DispatchEvent(e)==true)return};s.processclick=function(e){if(s.DispatchEvent(e)==true)return;if(s.Click){var a=s.m_currentMouseDownX-e.clientX;var b=s.m_currentMouseDownY-e.clientY;if((a*a+b*b)<=4){var r=s.m_Canvas[s.m_nOverlayIndex].getBoundingClientRect();e.m_clientX=e.clientX-r.left;e.m_clientY=e.clientY-r.top;s.Click(e)}}};s.processmouseup=function(e){VBI.m_bTrace&&VBI.Trace("processmouseup");if(s.DispatchEvent(e)==true)return;s.SetMoveMode(false);e.preventDefault();return false};s.processmousemove=function(e){var T;if(T=s.IsTransparent(e.clientX,e.clientY)){s.SetToolTip("");s.SetCursor('default')}s.SetCursor(T?'default':'pointer');e.preventDefault();if(s.DispatchEvent(e)==true)return;if(s.m_bMove){if(!(e.buttons==1||e.which==1)){s.SetMoveMode(false);return false}var a=e.clientX-s.m_currentMouseX;var b=e.clientY-s.m_currentMouseY;s.m_currentMouseX=e.clientX;s.m_currentMouseY=e.clientY;s.MoveMap(a,b);return false}};s.processmousewheel=function(e){VBI.m_bTrace&&VBI.Trace("processmousewheel");e.m_OffsetX=e.offsetX;e.m_OffsetY=e.offsetY;e.m_Delta=e.wheelDelta;s.processcommonwheel(e);return false};s.processwheel=function(e){VBI.m_bTrace&&VBI.Trace("processwheel");var r=e.target.getBoundingClientRect();e.m_OffsetX=e.clientX-r.left;e.m_OffsetY=e.clientY-r.top;e.m_Delta=-e.deltaY;s.processcommonwheel(e);return false};s.processcommonwheel=function(e){VBI.m_bTrace&&VBI.Trace("processcommonwheel");if(s.DispatchEvent(e)==true)return;if(!s.m_SuppressedNavigation.zoom){if(e.m_Delta>0)s.ZoomMap(s.m_nLodFactorZoomIn,e.m_OffsetX,e.m_OffsetY);else if(e.m_Delta<0)s.ZoomMap(s.m_nLodFactorZoomOut,e.m_OffsetX,e.m_OffsetY);e.preventDefault()}return false}}else{var h=false;s.ontouchstart=function(e){VBI.m_bTrace&&VBI.Trace("touchstart");if(s.DispatchEvent(e)==true)return;window.clearTimeout(d);if(e.touches.length==1&&!s.m_SuppressedNavigation.move){s.m_bMove=true;var a=e.touches[0];s.m_currentMouseX=a.clientX;s.m_currentMouseY=a.clientY;VBI.m_bTrace&&VBI.Trace("touchstart"+"X:"+s.m_currentMouseX+"Y:"+s.m_currentMouseY);h=true}else if(e.touches.length==2){s.m_bMove=false;s.m_bTwoFingerTap=true;var b=e.touches[0];var f=e.touches[1];var g=b.clientX+(f.clientX-b.clientX)/2;var i=b.clientY+(f.clientY-b.clientY)/2;s.m_currentMouseX=g;s.m_currentMouseY=i;s.m_midPointX=g;s.m_midPointY=i;var j=Math.sqrt(Math.pow(b.clientX-f.clientX,2)+Math.pow(b.clientY-f.clientY,2));s.m_currentTouchDistance=j;VBI.m_bTrace&&VBI.Trace("touchstart"+"X1:"+b.clientX+"Y1:"+b.clientY+"X2:"+f.clientX+"Y2:"+f.clientY);h=true}if(h){e.preventDefault();return false}};s.ontouchend=function(e){VBI.m_bTrace&&VBI.Trace("touchend");var r=s.m_Canvas[s.m_nOverlayIndex].getBoundingClientRect();e.offsetX=s.m_currentMouseX-r.left;e.offsetY=s.m_currentMouseY-r.top;if(s.DispatchEvent(e)==true)return;if(s.m_bTwoFingerTap){s.AnimateZoom(false)}else{s.HandleDoubleTap(e)}if(!s.m_bAnimZoomDone)s.InternalRenderLayer(s.m_Canvas[s.m_nOverlayIndex],false);s.m_bMove=false;s.m_bAnimZoomDone=false;s.m_currentTouchDistance=0;s.m_currentMouseX=0;s.m_currentMouseY=0;e.preventDefault()};s.ontouchcancel=function(e){VBI.m_bTrace&&VBI.Trace("touchcancel");if(s.DispatchEvent(e)==true)return;s.m_bMove=false;e.preventDefault()};s.ontouchmove=function(e){VBI.m_bTrace&&VBI.Trace("touchmove");var h=false;s.m_nTapCount=0;if(s.DispatchEvent(e)==true)return;if(e.touches.length==1){if(!s.m_bMove)return;var a=e.touches[0];VBI.m_bTrace&&VBI.Trace("ontouchmove "+"X1:"+a.pageX+"Y1:"+a.pageY);var b=a.clientX-s.m_currentMouseX;var f=a.clientY-s.m_currentMouseY;s.m_currentMouseX=a.clientX;s.m_currentMouseY=a.clientY;s.MoveMap(b,f);m_currentMouseX=a.clientX;m_currentMouseY=a.clientY;h=true}else if(e.touches.length==2){if(!s.m_SuppressedNavigation.zoom){s.m_bTwoFingerTap=false;var g=e.touches[0];var i=e.touches[1];var j=g.clientX+(i.clientX-g.clientX)/2;var k=g.clientY+(i.clientY-g.clientY)/2;var r=s.m_Canvas[0].getBoundingClientRect();j-=r.left;k-=r.top;var l=Math.sqrt(Math.pow(g.clientX-i.clientX,2)+Math.pow(g.clientY-i.clientY,2));if(Math.abs(s.m_currentTouchDistance-l)>10){var z=(l>s.m_currentTouchDistance)?true:false;s.m_currentTouchDistance=l;VBI.m_bTrace&&VBI.Trace("ontouchmove "+" X1:"+g.pageX+" Y1:"+g.pageY+" X2:"+i.pageX+" Y2:"+i.pageY);s.ZoomMap(z?s.m_nLodFactorZoomIn:s.m_nLodFactorZoomOut,j,k)}h=true}}if(h){e.preventDefault();return false}}}s.HandleClick=function(e){var r=s.m_Canvas[s.m_nOverlayIndex].getBoundingClientRect();e.m_clientX=s.m_currentMouseX-r.left;e.m_clientY=s.m_currentMouseY-r.top;if(s.Click)s.Click(e)};s.MoveObject=function(o,x,y,w,a){o.style.left=x.toString()+"px";o.style.top=y.toString()+"px";if(w!==undefined)o.style.width=w.toString()+"px";if(a!==undefined)o.style.height=a.toString()+"px"};s.MoveObjectCanvas=function(x,y,w,a){var b=s.m_Canvas[2];VBI.m_bTrace&&VBI.Trace("MoveObjectCanvas"+" X:"+x+" Y:"+y+" Width:"+w+" Height:"+a);s.MoveObject(b,x,y,w,a)};s.MoveCanvas=function(a,x,y,w,b){s.MoveObjectCanvas(x,y,w,b);s.MoveObject(a,x,y,w,b)};s.MoveOnlyThisCanvas=function(a,x,y,w,b){s.MoveObject(a,x,y,w,b)};s.MoveMap=function(a,b){VBI.m_bTrace&&VBI.Trace("MoveMap"+" DX:"+a+" DY:"+b);var e=s.m_Canvas[0];var n=e.getPixelWidth()/s.m_nTilesX;var f=e.getPixelHeight()/s.m_nTilesY;var g;var i=e.m_nCurrentX,j=e.m_nCurrentY,k=0,l=0;var o=e.getPixelLeft()+a;var p=e.getPixelTop()+b;if((a>0)&&(g=o+s.m_nMapMovePreLoad)>0){k=Math.ceil(g/n);i-=k}else if((a<0)&&(g=(s.m_nMapMovePreLoad+s.m_Div.clientWidth-(o+e.getPixelWidth())))>0){k=-Math.ceil(g/n);i-=k}if((b>0)&&(g=p+s.m_nMapMovePreLoad)>0){l=Math.ceil(g/f);j-=l}else if((b<0)&&(g=(s.m_nMapMovePreLoad+s.m_Div.clientHeight-(p+e.getPixelHeight())))>0){l=-Math.ceil(g/f);j-=l}if(l&&((j>(1<<e.m_nCurrentLOD)-2)||(j<-1)))return;if(k||l){var q=s.m_Canvas[1].getContext("2d");q.clearRect(0,0,e.m_Scene.m_Canvas[1].width,e.m_Scene.m_Canvas[1].height);if(s.m_bIsIDevice)s.MoveWithTileJumpIDev(e,o,p,k,l,n,f,i,j);else s.MoveWithTileJumpDesktop(e,o,p,k,l,n,f,i,j)}else{s.MoveCanvas(e,o,p);s.MoveObject(s.m_Canvas[1],s.m_Canvas[1].getPixelLeft()+a,s.m_Canvas[1].getPixelTop()+b)}if(k||l){s.InternalRenderLayer(s.m_Canvas[s.m_nOverlayIndex],false);s.InternalOnMoveLayer(s.m_Canvas[s.m_nOverlayIndex])}};s.MoveWithTileJumpIDev=function(a,n,b,e,f,g,i,j,k){s.MoveCanvas(a.m_Scene.m_Canvas[0],n-e*g,b-f*i);var l=a.getContext("2d");l.clearRect(0,0,a.getPixelWidth(),a.getPixelHeight());a.m_Scene.m_MapManager.RequestTiles(a.m_Scene.m_Canvas[0],a.m_Scene.m_MapLayerStack,j,k,a.m_Scene.m_nTilesX,a.m_Scene.m_nTilesY,0,0,0,0,a.m_nCurrentLOD,false)};s.MoveWithTileJumpDesktop=function(a,n,b,e,f,g,i,j,k){VBI.m_bTrace&&VBI.Trace("MoveWithTileJumpDesktop OffsetX="+e+" OffsetY="+f);var l=a.width;var o=a.height;var p=e*256;var q=f*256;var x=0;var r=l;var u=0,v=0,w=0,z=0;var A=0,B=0;var C=a.getContext("2d");C.fillStyle='white';if(e){if(e<0){r=l+p;for(var D=0;D<(s.m_nTilesX+e);D++){C.clearRect(D*256,0,256,o);C.drawImage(a,(D-e)*256,0,256,o,D*256,0,256,o)}C.clearRect(r,0,-p,o);u=a.m_Scene.m_nTilesX+e;A=-e}else{x=p;for(var D=s.m_nTilesX-1;D>=e;D--){C.clearRect(D*256,0,256,o);C.drawImage(a,(D-e)*256,0,256,o,D*256,0,256,o)}C.clearRect(0,0,x,o);v=a.m_Scene.m_nTilesX-e;B=e}a.m_Scene.m_MapManager.RequestTiles(a,a.m_Scene.m_MapLayerStack,j,k,a.m_Scene.m_nTilesX,a.m_Scene.m_nTilesY,u,0,v,0,a.m_nCurrentLOD,false)}if(f){if(f<0){for(var D=0;D<(s.m_nTilesY+f);D++){C.clearRect(x,D*256,r,256);C.drawImage(a,x,(D-f)*256,r-x,256,x,D*256,r-x,256)}C.clearRect(x,o+q,r,o);w=a.m_Scene.m_nTilesY+f}if(f>0){for(var D=s.m_nTilesY-1;D>=f;D--){C.clearRect(x,D*256,r,256);C.drawImage(a,x,(D-f)*256,l-x,256,x,D*256,l-x,256)}C.clearRect(x,0,r,q);z=a.m_Scene.m_nTilesY-f}a.m_Scene.m_MapManager.RequestTiles(a,a.m_Scene.m_MapLayerStack,j,k,a.m_Scene.m_nTilesX,a.m_Scene.m_nTilesY,A,w,B,z,a.m_nCurrentLOD,false)}s.MoveCanvas(a,n-e*a.getPixelWidth()/s.m_nTilesX,b-f*a.getPixelHeight()/s.m_nTilesY)};s.CopyCanvas=function(a,b,e,f,g,C){var i=f-g.m_nCurrentLOD;var p=Math.pow(2,i);var j=(p*g.m_nCurrentX-b)*s.m_nWidthCanvas/s.m_nTilesX;var k=(p*g.m_nCurrentY-e)*s.m_nHeightCanvas/s.m_nTilesY;var l=p*s.m_nWidthCanvas;var n=p*s.m_nHeightCanvas;if(C){a.fillStyle="#FFFFFF";a.fillRect(0,0,s.m_Canvas[1].width,s.m_Canvas[1].height)}a.drawImage(g,0,0,s.m_nWidthCanvas,s.m_nHeightCanvas,j,k,l,n)};s.ZoomMap=function(f,x,a){var A=true;var b=s.m_Canvas[0];var n=(1<<b.m_nCurrentLOD);s.m_bZoom=true;if((b.m_nCurrentY<0)&&(a<-b.m_nCurrentY*(b.getPixelHeight()/s.m_nTilesY)))return;if(((b.m_nCurrentY+s.m_nTilesY)>n)&&(a>(n-b.m_nCurrentY)*(b.getPixelHeight()/s.m_nTilesY)))return;if(f<1){var e=(s.m_Div.clientWidth/b.getPixelWidth())*(s.m_nTilesX/n);if(f<e){if((e>=1)&&(f!=0))return;f=e;A=false}}var g=b.m_nExactLOD+Math.log(f)*Math.LOG2E;if(A&&Math.round(s.m_nTicksInALod*g)!=s.m_nTicksInALod*g){g=Math.round(s.m_nTicksInALod*g)/s.m_nTicksInALod;f=Math.pow(2,g-b.m_nExactLOD)}if(s.m_bIsIDevice||s.m_bIsAndroid)s.InternalRenderLayer(s.m_Canvas[s.m_nOverlayIndex],true);var o=b.getPixelWidth()/s.m_nTilesX;var i=b.getPixelHeight()/s.m_nTilesY;var j=s.m_Div.clientWidth/2-b.getPixelLeft()-x;var k=s.m_Div.clientHeight/2-b.getPixelTop()-a;var l=Math.round(b.getPixelWidth()*f);var p=Math.round(b.getPixelHeight()*f);var q=Math.floor(g+s.m_nOverzoom);if((q>s.m_MapLayerStack.GetMaxLOD())||(q<s.m_MapLayerStack.GetMinLOD()))return;var r=Math.round(b.getPixelLeft()-((f-1)*x));var u=Math.round(b.getPixelTop()-((f-1)*a));var v=x+b.getPixelLeft()-s.m_Canvas[1].getPixelLeft();var w=a+b.getPixelTop()-s.m_Canvas[1].getPixelTop();s.MoveCanvas(b,r,u,l,p);var z=l/s.m_nTilesX;var B=p/s.m_nTilesY;if(q>b.m_nCurrentLOD){var C=1<<(q-b.m_nCurrentLOD);var D=x+j/C;var E=a+k/C;var F=Math.round(C*D/o-s.m_nTilesX/2);var G=Math.round(C*E/i-s.m_nTilesY/2);var H=Math.ceil(r+F*z/C);var I=Math.ceil(u+G*B/C);r=Math.ceil(b.m_nCurrentX*C+F);u=Math.ceil(b.m_nCurrentY*C+G);s.MoveCanvas(b.m_Scene.m_Canvas[1],H,I,Math.ceil(l/C),Math.ceil(p/C));var J=b.m_Scene.m_Canvas[1].getContext("2d");J.fillStyle='white';J.clearRect(0,0,J.canvas.width,J.canvas.height);s.m_MapManager.RequestTiles(s.m_Canvas[1],s.m_MapLayerStack,r,u,s.m_nTilesX,s.m_nTilesY,0,0,0,0,q,true);b.m_Scene.ToggleCanvas(b.m_Scene)}else if(q<b.m_nCurrentLOD){var C=1<<(b.m_nCurrentLOD-q);var K=((b.m_nCurrentX%C)+C)%C;var L=((b.m_nCurrentY%C)+C)%C;var D=x+C*j;var E=a+C*k;var F=Math.round((D/o+K)/C-s.m_nTilesX/2);var G=Math.round((E/i+L)/C-s.m_nTilesY/2);var H=r+z*(F*C-K);var I=u+B*(G*C-L);s.MoveCanvas(b.m_Scene.m_Canvas[1],H,I,Math.ceil(l*C),Math.ceil(p*C));r=Math.floor(b.m_nCurrentX/C+F);u=Math.floor(b.m_nCurrentY/C+G);var J=b.m_Scene.m_Canvas[1].getContext("2d");J.fillStyle='white';J.clearRect(0,0,J.canvas.width,J.canvas.height);b.m_Scene.m_MapManager.RequestTiles(b.m_Scene.m_Canvas[1],b.m_Scene.m_MapLayerStack,r,u,b.m_Scene.m_nTilesX,b.m_Scene.m_nTilesY,0,0,0,0,q,true);b.m_Scene.ToggleCanvas(b.m_Scene)}else{s.ZoomOtherCanvas(s.m_Canvas[1],b,f,v,w);if(r>0||u>0||(r+l<s.m_Div.clientWidth)||(u+p<s.m_Div.clientHeight)){var F=-Math.ceil(r/z);var G=-Math.ceil(u/B);var H=r+F*z;var I=u+G*B;r=b.m_nCurrentX+F;u=b.m_nCurrentY+G;s.MoveCanvas(b.m_Scene.m_Canvas[1],H,I,l,p);b.m_Scene.m_MapManager.RequestTiles(b.m_Scene.m_Canvas[1],b.m_Scene.m_MapLayerStack,r,u,b.m_Scene.m_nTilesX,b.m_Scene.m_nTilesY,0,0,0,0,b.m_nCurrentLOD,true);b.m_Scene.ToggleCanvas(b.m_Scene)}}var M=s.m_Canvas[0];M.m_nExactLOD=M.m_nCurrentLOD+Math.log(M.getPixelWidth()/(256*s.m_nTilesX))*Math.LOG2E;if(s.m_bNavControlVisible&&s.m_NavControl)s.m_NavControl.AdjustScrollPoint(M.m_nCurrentLOD);if(!s.m_bIsIDevice&&!s.m_bIsAndroid)s.InternalRenderLayer(s.m_Canvas[s.m_nOverlayIndex],false);s.InternalOnZoomLayer(s.m_Canvas[s.m_nOverlayIndex])};s.ZoomOtherCanvas=function(o,a,f,x,b){var n=Math.round(o.getPixelLeft()-((f-1)*x));var e=Math.round(o.getPixelTop()-((f-1)*b));var g=Math.round(o.getPixelWidth()*f);var i=Math.round(o.getPixelHeight()*f);s.MoveObject(o,n,e,g,i)};s.AnimateZoom=function(z){if(!z){var a=window.setInterval(function(){var r=s.m_Canvas[0].getBoundingClientRect();var x=s.m_midPointX;var e=s.m_midPointY;x-=r.left;e-=r.top;s.ZoomMap(0.93,x,e)},33);window.setTimeout(function(){window.clearInterval(a);s.InternalRenderLayer(s.m_Canvas[s.m_nOverlayIndex],false);s.m_bTwoFingerTap=false;s.m_bAnimZoomDone=true},300)}else{var b=window.setInterval(function(){var r=s.m_Canvas[0].getBoundingClientRect();var x=s.m_oldMouseX;var e=s.m_oldMouseY;x-=r.left;e-=r.top;s.ZoomMap(1.07,x,e)},33);window.setTimeout(function(){window.clearInterval(b);s.InternalRenderLayer(s.m_Canvas[s.m_nOverlayIndex],false);s.m_bAnimZoomDone=true},300)}};s.HandleDoubleTap=function(e){m_SingleTapEvent=e;var a=s.m_currentMouseX-s.m_oldMouseX;var b=s.m_currentMouseY-s.m_oldMouseY;if((a*a+b*b)<=1000){s.m_nTapCount++;if(s.m_nTapCount>2)s.m_nTapCount=0}if(s.m_nTapCount==2){s.AnimateZoom(true);return}window.setTimeout(function(){s.m_nTapCount=0},200);s.m_nTapCount=1;s.m_oldMouseX=s.m_currentMouseX;s.m_oldMouseY=s.m_currentMouseY;s.HandleClick(e);e.preventDefault()};s.IsTransparent=function(a,b){var C=s.m_Canvas[s.m_nOverlayIndex];if(!C)return false;var r=C.getBoundingClientRect();var n=Math.round((a-r.left)/s.m_ZoomFactors[0]);var e=Math.round((b-r.top)/s.m_ZoomFactors[1]);if(!s.m_OverlayImageData){var f=C.getContext("2d");s.m_OverlayImageData=f.getImageData(0,0,s.m_nWidthCanvas,s.m_nHeightCanvas).data}var g=(e*s.m_nWidthCanvas+n)*4+3;if((g<0)||(g>=(s.m_nWidthCanvas*s.m_nHeightCanvas*4))){VBI.m_bTrace&&VBI.Trace("GeoScene::IsTransparent coordinate out of bounds");return true}var i=s.m_OverlayImageData[g];return i?false:true};s.GetCurrentZoomFactors=function(){return s.m_ZoomFactors};s.ToggleCanvas=function(s){var a=s.m_Canvas[0];s.m_Canvas[0]=s.m_Canvas[1];s.m_Canvas[1]=a;s.m_Canvas[0].style.opacity=0.0;s.m_Canvas[1].style.opacity=1.0;a=s.m_Canvas[0].style.zIndex;s.m_Canvas[0].style.zIndex=s.m_Canvas[1].style.zIndex;s.m_Canvas[1].style.zIndex=a;s.BlendCanvas()};s.BlendCanvas=function(){if(s.m_BlendTimer!=null)window.clearInterval(s.m_BlendTimer);var n=parseFloat(s.m_Canvas[0].style.opacity);if(n<1.0){s.m_BlendTimer=window.setInterval(s.BlendCanvas,40);s.m_Canvas[0].style.opacity=n+0.1}else{window.clearInterval(s.m_BlendTimer)}};s.GetPointFromPos=function(p,a,l,f){var b=VBI.MathLib.DegToRad(p);return s.GetPointFromGeo(b,a,l,f)};s.GetPointFromGeo=function(l,a,b,f){var e=s.m_Canvas[0];var n=e.m_nCurrentLOD;var g=s.m_nWidthCanvas/s.m_nTilesX;var i=s.m_nHeightCanvas/s.m_nTilesY;var j=(1<<n);var k,o;var u=[k=j*g,o=j*i];u=VBI.MathLib.LonLatToUCS(l,u);u[0]=u[0]-(e.m_nCurrentX*g);u[1]=(o-u[1])-(e.m_nCurrentY*i);u.m_nIndex=0;if(a){while((u[0]<0)&&((k<e.getPixelWidth())||((u[0]+k)<(e.getPixelWidth()-u[0]))))u[0]+=k;while((u[0]>k)&&((k<e.getPixelWidth())||((k-u[0])<(u[0]-e.getPixelWidth()))))u[0]-=k;var p=f?2:1;if(f||((2*s.m_nWidthCanvas)>k)){var q=(-e.getPixelLeft()/e.getPixelWidth())*s.m_nWidthCanvas;var r=((s.m_Div.clientWidth-e.getPixelLeft())/e.getPixelWidth())*s.m_nWidthCanvas;var v=0;for(var w=u[0]-p*k;w<=s.m_nWidthCanvas+p*k;w+=k){if(f){if(Math.abs(b[0]-w)<=k/2){u[0]=w;u.m_nIndex=v;break}}else{if((w>q)&&(w<r)){u[0]=w;u.m_nIndex=v;break}}if((b!=undefined)&&(Math.abs(b[0]-w)<k/2))u[0]=w;v++}}}if(b!=undefined)u.m_bIsNearest=(Math.abs(b[0]-u[0])<=k/2);var x,y;u.m_bVisible=(((x=u[0])>0)&&((y=u[1])>0)&&(x<e.getPixelWidth())&&(y<e.getPixelHeight()));return u};s.GetPointsFromPos=function(p,i,l){var a=VBI.MathLib.DegToRad(p);return s.GetPointsFromGeo(a,i,l)};s.GetPointsFromGeo=function(l,i,a){var b=s.m_Canvas[0];var n=b.m_nCurrentLOD;var e=s.m_nWidthCanvas/s.m_nTilesX;var f=s.m_nHeightCanvas/s.m_nTilesY;var g=(1<<n);var j,k;var u=[j=g*e,k=g*f];var o=[];u=VBI.MathLib.LonLatToUCS(l,u);u[0]=u[0]-(b.m_nCurrentX*e);u[1]=(k-u[1])-(b.m_nCurrentY*f);u.m_nIndex=0;while((u[0]<0)&&((j<b.getPixelWidth())||((u[0]+j)<(b.getPixelWidth()-u[0]))))u[0]+=j;while((u[0]>j)&&((j<b.getPixelWidth())||((j-u[0])<(u[0]-b.getPixelWidth()))))u[0]-=j;var p=0;if((2*s.m_nWidthCanvas)>j){var q=i?u[0]-j:u[0];var r=i?s.m_nWidthCanvas+j:s.m_nWidthCanvas;for(var x=q;x<r;x+=j){u[0]=x;o.push([].concat(u));o[p].m_bVisible=((x>0)&&((y=u[1])>0)&&(x<b.getPixelWidth())&&(y<b.getPixelHeight()));p++}}else{u.m_bVisible=(((x=u[0])>0)&&((y=u[1])>0)&&(x<b.getPixelWidth())&&(y<b.getPixelHeight()));o.push(u)}return o};s.GetGeoFromPoint=function(p){var a=s.m_Canvas[0];var n=a.m_nCurrentLOD;var b=(1<<n);var e=p[0]*s.m_nWidthCanvas/a.getPixelWidth();var f=p[1]*s.m_nHeightCanvas/a.getPixelHeight();var g=s.m_nWidthCanvas/s.m_nTilesX;var i=s.m_nHeightCanvas/s.m_nTilesY;var j=a.m_nCurrentX*g;var k=a.m_nCurrentY*i;var l=j+e;var o=k+f;var q=b*g;var r=b*i;while(l<0)l+=q;while(o<0)o+=r;while(l>q)l-=q;while(o>r)o-=r;var u=[0,0];var v=[l/q*2.0-1.0,o/r*2.0-1.0];return VBI.MathLib.UCSToLonLat(v,u)};s.getCanvas=function(){return s.m_Canvas[0]};s.Remove=function(){if(s.m_Div){var n;for(n=0;n<s.m_Canvas.length;++n)s.m_Canvas[n].m_Scene=null;if(s.m_BlendTimer){window.clearInterval(s.m_BlendTimer);s.m_BlendTimer=null}var C=s.m_Canvas[s.m_nOverlayIndex];C.onmousedown=C.onmouseup=C.onmousewheel=C.onclick=C.ontouchstart=C.ontouchend=C.ontouchmove=C.ontouchcancel=C.onmousemove=C.onwheel=C.onmouseout=C.oncontextmenu=null;s.SetMoveMode(false);while(s.m_Div.firstChild)s.m_Div.removeChild(s.m_Div.firstChild);s.m_Div.parentElement.removeChild(s.m_Div);s.m_Div=null;for(n=0;n<s.m_Canvas.length;++n)s.m_Canvas[n]=null}if(s.m_Target){while(s.m_Target.firstChild)s.m_Target.removeChild(s.m_Target.firstChild)}};s.AddCopyright=function(){var C=VBI.Utilities.CreateGeoSceneDivCSS(s.m_Target.id+"-copyright","copyright");s.m_Div.appendChild(C);s.m_DivCopyright=C;var a=s.m_MapLayerStack.GetCopyright();if(a){s.m_DivCopyright.innerHTML=a}else{s.m_DivCopyright.style.paddingRight=0;s.m_DivCopyright.style.paddingLeft=0}};s.Awake=function(t,m,c){if(!(s.m_Target=VBI.Utilities.GetDOMElement(t)))s.m_Target=VBI.Utilities.CreateDOMElement(t,"1px","1px");if(s.m_Div){if(s.m_Div.parentNode==s.m_Target)return;s.m_Target.appendChild(s.m_Div);if(s.m_bNavControlVisible&&s.m_NavControl)s.m_NavControl.AttachEvents();return}s.m_TargetName=t;s.m_MapManager=typeof m!=='undefined'?m:VBI.MapManager;s.m_MapLayerStack=typeof c!=='undefined'?c:s.m_RefMapLayerStack;s.m_Div=VBI.Utilities.CreateGeoSceneDiv("GeoScene");s.m_Target.appendChild(s.m_Div);s.CalcCanvasWidth=function(){return(Math.floor(s.m_Div.clientWidth/s.m_MapManager.m_tileWidth)+s.m_nCanvasXOversize)*s.m_MapManager.m_tileWidth};s.CalcCanvasHeight=function(){return(Math.floor(s.m_Div.clientHeight/s.m_MapManager.m_tileHeight)+s.m_nCanvasYOversize)*s.m_MapManager.m_tileHeight};s.CalcNumTilesX=function(){return s.CalcCanvasWidth()/s.m_MapManager.m_tileWidth};s.CalcNumTilesY=function(){return s.CalcCanvasHeight()/s.m_MapManager.m_tileHeight};s.m_nWidthCanvas=s.CalcCanvasWidth();s.m_nHeightCanvas=s.CalcCanvasHeight();s.m_nTilesX=s.CalcNumTilesX();s.m_nTilesY=s.CalcNumTilesY();s.m_nMaximalOversizeZoom=Math.min((s.m_nTilesX+s.m_nCanvasXOversize)/(s.m_nTilesX+1),(s.m_nTilesY+s.m_nCanvasYOversize)/(s.m_nTilesY+1))-1;s.m_nMinimalOversizeZoom=-1;s.m_nMapMovePreLoad=Math.min(s.m_nMapMovePreLoad,(256*s.m_nTilesX-s.m_Div.clientWidth)/4,(256*s.m_nTilesY-s.m_Div.clientHeight)/4);s.m_Canvas.push(VBI.Utilities.CreateGeoSceneCanvas("MapToggleLayer1",s.m_nWidthCanvas,s.m_nHeightCanvas,2));s.m_Canvas.push(VBI.Utilities.CreateGeoSceneCanvas("MapToggleLayer2",s.m_nWidthCanvas,s.m_nHeightCanvas,1));s.m_Canvas.push(VBI.Utilities.CreateGeoSceneCanvas("MapObjectLayer",s.m_nWidthCanvas,s.m_nHeightCanvas,3));for(var n=0;n<s.m_Canvas.length;++n){s.m_Canvas[n].m_Scene=s;s.m_Canvas[n].m_nCurrentLOD=2;s.m_Canvas[n].m_nCurrentX=0;s.m_Canvas[n].m_nCurrentY=0;s.m_Div.appendChild(s.m_Canvas[n])}
// append copyright 
s.AddCopyright();var C=s.m_Canvas[s.m_nOverlayIndex];if(!s.m_bIsIDevice&&!s.m_bIsAndroid){C.onmousedown=s.processmousedown;C.onmouseup=s.processmouseup;C.onmousewheel=s.processmousewheel;C.onwheel=s.processwheel;C.onmouseout=s.processmouseout;C.onmousemove=s.processmousemove;C.onclick=s.processclick;C.oncontextmenu=s.processcontextmenu}else{C.ontouchstart=s.ontouchstart;C.ontouchend=s.ontouchend;C.ontouchmove=s.ontouchmove;C.ontouchcancel=s.ontouchcancel}if(s.m_bNavControlVisible&&s.m_NavControl){s.m_NavControl.Awake(s,t)}if(s.m_MapLayerStack.GetMinLOD()>s.m_startLOD)s.m_startLOD=s.m_MapLayerStack.GetMinLOD();s.GoToInitialStart()};if(t)s.Awake(t,m,c);return s};
