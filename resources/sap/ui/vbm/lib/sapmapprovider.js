 
VBI.MapProviders=function(){var m={};m.vbiclass="MapProviders";m.m_MapProviderArray=[];m.clear=function(){for(var n=0;n<m.m_MapProviderArray.length;++n)m.m_MapProviderArray[n].clear();m.m_MapProviderArray=[]};m.load=function(d,c){if(d.Set){var a;m.clear();if(d.Set.MapProvider){if(jQuery.type(d.Set.MapProvider)=='object'){a=new VBI.MapProvider();a.load(d.Set.MapProvider);m.Add(a)}else if(jQuery.type(d.Set.MapProvider)=='array'){for(var n=0;n<d.Set.MapProvider.length;++n){a=new VBI.MapProvider();a.load(d.Set.MapProvider[n]);m.Add(a)}}}}};m.Add=function(a){this.m_MapProviderArray.push(a)};m.GetMapProviderByName=function(n){for(var a=0;a<m.m_MapProviderArray.length;++a){if(m.m_MapProviderArray[a].m_Name==n)return m.m_MapProviderArray[a]}return null};return m};
VBI.MapProvider=function(n,d,c,t,a,m,b,f){var e={};e.vbiclass="MapProvider";e.m_SourceArray=[];e.m_Name=n;e.m_Description=d;e.m_Copyright=c;e.m_tileX=typeof t!=='undefined'?t:256;e.m_tileY=typeof a!=='undefined'?a:256;e.m_maxLOD=typeof b!=='undefined'?b:19;e.m_minLOD=typeof m!=='undefined'?m:0;if(f!=null)e.fillStyle=f;e.clear=function(){for(var g=0;g<e.m_SourceArray.length;++g)e.m_SourceArray[g].clear();e.m_SourceArray=[]};e.load=function(g){if(g.name)e.m_Name=g.name;if(g.description)e.m_Description=g.description;if(g.copyright)e.m_Copyright=g.copyright;if(g.tileX)e.m_tileX=g.tileX;if(g.tileY)e.m_tileY=g.tileY;if(g.maxLOD)e.m_maxLOD=g.maxLOD;if(g.minLOD)e.m_minLOD=g.minLOD;if(g.Source){if(jQuery.type(g.Source)=='object'){var s=new VBI.Source(null);s.load(g.Source);e.Add(s)}else if(jQuery.type(g.Source)=='array'){for(var h=0;h<g.Source.length;++h){var s=new VBI.Source(null);s.load(g.Source[h]);e.Add(s)}}}};e.Add=function(s){this.m_SourceArray.push(s)};e.CombineUrl=function(x,y,l){var g=1<<l;if(x<0||y<0||(x>=g)||(y>=g))return null;if(this.m_SourceArray.length==0)return null;return this.m_SourceArray[((y+x*g)%this.m_SourceArray.length)].CombineUrl(x,y,l)};e.GetMaxLOD=function(){return this.m_maxLOD};e.GetMinLOD=function(){return this.m_minLOD};return e};
VBI.Source=function(u){var s={};s.vbiclass="Source";s.m_ID=null;s.m_Url=u;s.clear=function(){};s.load=function(d){if(d.url)s.m_Url=d.url;if(d.id)s.m_ID=d.id};s.CombineUrl=function(x,y,l){var t=s.m_Url;t=t.replace("{X}",x);t=t.replace("{Y}",y);t=t.replace("{LOD}",l);t=t.replace("{QUAD}",this.TileXYToQuadKey(x,y,l));t=t.replace("{NUMT}",this.TileXYToNumKey(x,y,l));return t};s.TileXYToQuadKey=function(x,y,l){var q=[];for(var i=l;i>0;--i){var d='0';var m=1<<(i-1);if(x&m)d++;if(y&m){d++;d++}q.push(d)}var a=q.join("");return a};s.TileXYToNumKey=function(x,y,l){var n=0;for(var i=1;i<l;++i){n+=(1<<i)*(1<<i)}n+=(y*(1<<l)+x+1);return n};return s};
