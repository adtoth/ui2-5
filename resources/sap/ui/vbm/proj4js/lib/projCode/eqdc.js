Proj4js.Proj.eqdc={init:function(){if(!this.mode)this.mode=0;this.temp=this.b/this.a;this.es=1.0-Math.pow(this.temp,2);this.e=Math.sqrt(this.es);this.e0=Proj4js.common.e0fn(this.es);this.e1=Proj4js.common.e1fn(this.es);this.e2=Proj4js.common.e2fn(this.es);this.e3=Proj4js.common.e3fn(this.es);this.sinphi=Math.sin(this.lat1);this.cosphi=Math.cos(this.lat1);this.ms1=Proj4js.common.msfnz(this.e,this.sinphi,this.cosphi);this.ml1=Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat1);if(this.mode!=0){if(Math.abs(this.lat1+this.lat2)<Proj4js.common.EPSLN){Proj4js.reportError("eqdc:Init:EqualLatitudes")}this.sinphi=Math.sin(this.lat2);this.cosphi=Math.cos(this.lat2);this.ms2=Proj4js.common.msfnz(this.e,this.sinphi,this.cosphi);this.ml2=Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat2);if(Math.abs(this.lat1-this.lat2)>=Proj4js.common.EPSLN){this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)}else{this.ns=this.sinphi}}else{this.ns=this.sinphi}this.g=this.ml1+this.ms1/this.ns;this.ml0=Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0);this.rh=this.a*(this.g-this.ml0)},forward:function(p){var l=p.x;var a=p.y;var m=Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,a);var r=this.a*(this.g-m);var t=this.ns*Proj4js.common.adjust_lon(l-this.long0);var x=this.x0+r*Math.sin(t);var y=this.y0+this.rh-r*Math.cos(t);p.x=x;p.y=y;return p},inverse:function(p){p.x-=this.x0;p.y=this.rh-p.y+this.y0;var c,r;if(this.ns>=0){r=Math.sqrt(p.x*p.x+p.y*p.y);c=1.0}else{r=-Math.sqrt(p.x*p.x+p.y*p.y);c=-1.0}var t=0.0;if(r!=0.0)t=Math.atan2(c*p.x,c*p.y);var m=this.g-r/this.a;var l=this.phi3z(m,this.e0,this.e1,this.e2,this.e3);var a=Proj4js.common.adjust_lon(this.long0+t/this.ns);p.x=a;p.y=l;return p},phi3z:function(m,e,a,b,c){var p;var d;p=m;for(var i=0;i<15;i++){d=(m+a*Math.sin(2.0*p)-b*Math.sin(4.0*p)+c*Math.sin(6.0*p))/e-p;p+=d;if(Math.abs(d)<=.0000000001){return p}}Proj4js.reportError("PHI3Z-CONV:Latitude failed to converge after 15 iterations");return null}};
