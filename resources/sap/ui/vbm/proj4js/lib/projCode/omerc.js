Proj4js.Proj.omerc={init:function(){if(!this.mode)this.mode=0;if(!this.lon1){this.lon1=0;this.mode=1}if(!this.lon2)this.lon2=0;if(!this.lat2)this.lat2=0;var t=this.b/this.a;var a=1.0-Math.pow(t,2);var e=Math.sqrt(a);this.sin_p20=Math.sin(this.lat0);this.cos_p20=Math.cos(this.lat0);this.con=1.0-this.es*this.sin_p20*this.sin_p20;this.com=Math.sqrt(1.0-a);this.bl=Math.sqrt(1.0+this.es*Math.pow(this.cos_p20,4.0)/(1.0-a));this.al=this.a*this.bl*this.k0*this.com/this.con;if(Math.abs(this.lat0)<Proj4js.common.EPSLN){this.ts=1.0;this.d=1.0;this.el=1.0}else{this.ts=Proj4js.common.tsfnz(this.e,this.lat0,this.sin_p20);this.con=Math.sqrt(this.con);this.d=this.bl*this.com/(this.cos_p20*this.con);if((this.d*this.d-1.0)>0.0){if(this.lat0>=0.0){this.f=this.d+Math.sqrt(this.d*this.d-1.0)}else{this.f=this.d-Math.sqrt(this.d*this.d-1.0)}}else{this.f=this.d}this.el=this.f*Math.pow(this.ts,this.bl)}if(this.mode!=0){this.g=.5*(this.f-1.0/this.f);this.gama=Proj4js.common.asinz(Math.sin(this.alpha)/this.d);this.longc=this.longc-Proj4js.common.asinz(this.g*Math.tan(this.gama))/this.bl;this.con=Math.abs(this.lat0);if((this.con>Proj4js.common.EPSLN)&&(Math.abs(this.con-Proj4js.common.HALF_PI)>Proj4js.common.EPSLN)){this.singam=Math.sin(this.gama);this.cosgam=Math.cos(this.gama);this.sinaz=Math.sin(this.alpha);this.cosaz=Math.cos(this.alpha);if(this.lat0>=0){this.u=(this.al/this.bl)*Math.atan(Math.sqrt(this.d*this.d-1.0)/this.cosaz)}else{this.u=-(this.al/this.bl)*Math.atan(Math.sqrt(this.d*this.d-1.0)/this.cosaz)}}else{Proj4js.reportError("omerc:Init:DataError")}}else{this.sinphi=Math.sin(this.at1);this.ts1=Proj4js.common.tsfnz(this.e,this.lat1,this.sinphi);this.sinphi=Math.sin(this.lat2);this.ts2=Proj4js.common.tsfnz(this.e,this.lat2,this.sinphi);this.h=Math.pow(this.ts1,this.bl);this.l=Math.pow(this.ts2,this.bl);this.f=this.el/this.h;this.g=.5*(this.f-1.0/this.f);this.j=(this.el*this.el-this.l*this.h)/(this.el*this.el+this.l*this.h);this.p=(this.l-this.h)/(this.l+this.h);this.dlon=this.lon1-this.lon2;if(this.dlon<-Proj4js.common.PI)this.lon2=this.lon2-2.0*Proj4js.common.PI;if(this.dlon>Proj4js.common.PI)this.lon2=this.lon2+2.0*Proj4js.common.PI;this.dlon=this.lon1-this.lon2;this.longc=.5*(this.lon1+this.lon2)-Math.atan(this.j*Math.tan(.5*this.bl*this.dlon)/this.p)/this.bl;this.dlon=Proj4js.common.adjust_lon(this.lon1-this.longc);this.gama=Math.atan(Math.sin(this.bl*this.dlon)/this.g);this.alpha=Proj4js.common.asinz(this.d*Math.sin(this.gama));if(Math.abs(this.lat1-this.lat2)<=Proj4js.common.EPSLN){Proj4js.reportError("omercInitDataError")}else{this.con=Math.abs(this.lat1)}if((this.con<=Proj4js.common.EPSLN)||(Math.abs(this.con-Proj4js.common.HALF_PI)<=Proj4js.common.EPSLN)){Proj4js.reportError("omercInitDataError")}else{if(Math.abs(Math.abs(this.lat0)-Proj4js.common.HALF_PI)<=Proj4js.common.EPSLN){Proj4js.reportError("omercInitDataError")}}this.singam=Math.sin(this.gam);this.cosgam=Math.cos(this.gam);this.sinaz=Math.sin(this.alpha);this.cosaz=Math.cos(this.alpha);if(this.lat0>=0){this.u=(this.al/this.bl)*Math.atan(Math.sqrt(this.d*this.d-1.0)/this.cosaz)}else{this.u=-(this.al/this.bl)*Math.atan(Math.sqrt(this.d*this.d-1.0)/this.cosaz)}}},forward:function(p){var a;var d,e;var b;var c,t,f;var g,n,m;var q,u,v;var h,i;var s;var j;var k;var l=p.x;var o=p.y;d=Math.sin(o);j=Proj4js.common.adjust_lon(l-this.longc);v=Math.sin(this.bl*j);if(Math.abs(Math.abs(o)-Proj4js.common.HALF_PI)>Proj4js.common.EPSLN){k=Proj4js.common.tsfnz(this.e,o,d);q=this.el/(Math.pow(k,this.bl));s=.5*(q-1.0/q);t=.5*(q+1.0/q);h=(s*this.singam-v*this.cosgam)/t;g=Math.cos(this.bl*j);if(Math.abs(g)<.0000001){u=this.al*this.bl*j}else{u=this.al*Math.atan((s*this.cosgam+v*this.singam)/g)/this.bl;if(g<0)u=u+Proj4js.common.PI*this.al/this.bl}}else{if(o>=0){h=this.singam}else{h=-this.singam}u=this.al*o/this.bl}if(Math.abs(Math.abs(h)-1.0)<=Proj4js.common.EPSLN){Proj4js.reportError("omercFwdInfinity")}i=.5*this.al*Math.log((1.0-h)/(1.0+h))/this.bl;u=u-this.u;var x=this.x0+i*this.cosaz+u*this.sinaz;var y=this.y0+u*this.cosaz-i*this.sinaz;p.x=x;p.y=y;return p},inverse:function(p){var d;var a;var e;var f,g;var b;var c,t,h;var i,n,m;var v,u,q,s,j;var k,l,o;var r,w;var x;p.x-=this.x0;p.y-=this.y0;x=0;v=p.x*this.cosaz-p.y*this.sinaz;u=p.y*this.cosaz+p.x*this.sinaz;u=u+this.u;q=Math.exp(-this.bl*v/this.al);s=.5*(q-1.0/q);t=.5*(q+1.0/q);k=Math.sin(this.bl*u/this.al);l=(k*this.cosgam+s*this.singam)/t;if(Math.abs(Math.abs(l)-1.0)<=Proj4js.common.EPSLN){r=this.longc;if(l>=0.0){w=Proj4js.common.HALF_PI}else{w=-Proj4js.common.HALF_PI}}else{i=1.0/this.bl;j=Math.pow((this.el/Math.sqrt((1.0+l)/(1.0-l))),i);w=Proj4js.common.phi2z(this.e,j);a=this.longc-Math.atan2((s*this.cosgam-k*this.singam),i)/this.bl;r=Proj4js.common.adjust_lon(a)}p.x=r;p.y=w;return p}};
