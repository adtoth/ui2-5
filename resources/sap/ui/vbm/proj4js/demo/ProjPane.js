var panes={mapL:{},mapLL:{},mapR:{}};ProjPane=Class.create();ProjPane.prototype={id:null,map:null,proj:null,initialize:function(p,c){this.id=p;if(c)this.setProj(c)},updateCoords:function(c){document.getElementById(this.id+'_coords').innerHTML=c.toString();var p=this.map.getLayerPxFromLonLat(c);this.marker.moveTo(p)},setProj:function(c){document.getElementById(this.id+'_proj').value=c;this.proj=new Proj4js.Proj(c);var m=Proj4js.maps[this.proj.srsCode];if(this.map)this.map.destroy();this.map=new OpenLayers.Map(this.id,m.mapOptions);this.mapLayer=new OpenLayers.Layer.WMS(m.layerName,m.layerUrl,m.layerParams,m.layerOptions);this.map.addLayer(this.mapLayer);this.map.addLayer(new OpenLayers.Layer.Markers(''));this.marker=new OpenLayers.Marker(new OpenLayers.LonLat(0,0));this.map.layers[1].addMarker(this.marker);this.marker.map=this.map;if(window.bounds){this.map.addLayer(new OpenLayers.Layer.Boxes());this.map.layers[2].addMarker(new OpenLayers.Marker.Box(bounds));this.map.setCenter(bounds.getCenterLonLat())}else{this.map.zoomToMaxExtent()}this.map.events.register('click',this.map,this.mapClicked.bind(this));document.getElementById(this.id+'_units').innerHTML=this.proj.units;document.getElementById(this.id+'_title').innerHTML=this.proj.title;document.getElementById(this.id+'_class').innerHTML=this.proj.projName},mapClicked:function(e){var o=this.map.getLonLatFromViewPortPx(e.xy);c=new Proj4js.Point(o.lon,o.lat);this.updateCoords(c);if(this.opposite&&this.opposite.proj){var n=this.proj.transform(c,this.opposite.proj);this.opposite.updateCoords(n)}if(this.common){var n=this.proj.inverse(c);this.common.updateCoords(n)}if(this.projected1&&this.projected1.proj){var n=this.projected1.proj.forward(c);this.projected1.updateCoords(n)}if(this.projected2&&this.projected2.proj){var n=this.projected2.proj.forward(c);this.projected2.updateCoords(n)}}};
function init(){panes['mapLL']=new ProjPane('mapLL',Proj4js.defaultDatum);panes['mapL']=new ProjPane('mapL');panes['mapR']=new ProjPane('mapR');panes['mapLL'].projected1=panes['mapL'];panes['mapLL'].projected2=panes['mapR'];panes['mapL'].opposite=panes['mapR'];panes['mapR'].opposite=panes['mapL'];panes['mapL'].common=panes['mapLL'];panes['mapR'].common=panes['mapLL']}
;
