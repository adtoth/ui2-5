/*!
 * @copyright@
 */
sap.ui.controller("sap.collaboration.components.fiori.feed.app.App",{onInit:function(){this.oApp=this.getView().oApp;this.oOdataModel=this.getView().getViewData().odataModel;this.oLangBundle=this.getView().getViewData().langBundle;this.sPrefixId=this.getView().getViewData().controlId;this.sAppType=this.getView().getViewData().appType;this.sFeedType=this.getView().getViewData().feedType;this.sGroupIds=this.getView().getViewData().groupIds;this.oBusinessObject=this.getView().getViewData().object},onBeforeRendering:function(){this.initializeUtils();this.createDetailPage()},initializeUtils:function(){this.oODataUtil=new sap.collaboration.components.utils.OdataUtil()},createDetailPage:function(){var j=this.oODataUtil.getJamUrl(this.oOdataModel);var J=this.oODataUtil.getJamToken(this.oOdataModel);if(this.sAppType===sap.collaboration.AppType.widget){this.getGroupIds()}var d=sap.ui.view({id:this.sPrefixId+"detailView",viewData:{controlId:this.sPrefixId,jamURL:j,jamToken:J,appType:this.sAppType,feedType:this.sFeedType,groupIds:this.sGroupIds,object:this.oBusinessObject,langBundle:this.oLangBundle},type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.collaboration.components.fiori.feed.commons.Detail"});this.oApp.addPage(d);this.oApp.setInitialPage(d)},getGroupIds:function(){var g;if(this.sFeedType===sap.collaboration.FeedType.group&&(this.sGroupIds===undefined||this.sGroupIds==="")){g=this.oODataUtil.getGroupsData(this.oOdataModel,"/Groups");this.sGroupIds=this.oODataUtil.getGroupIds(g)}else if(this.sFeedType===sap.collaboration.FeedType.objectGroup&&(this.sGroupIds===undefined||this.sGroupIds==="")){g=this.oODataUtil.getGroupsData(this.oOdataModel,"/BusinessObjects('"+this.oBusinessObject.id+"')/AssignedGroups");this.sGroupIds=this.oODataUtil.getGroupIds(g)}else if(this.sFeedType===sap.collaboration.FeedType.objectGroup&&!(this.sGroupIds===undefined||this.sGroupIds==="")){g=this.oODataUtil.getGroupsData(this.oOdataModel,"/BusinessObjects('"+this.oBusinessObject.id+"')/AssignedGroups");var c=this.oODataUtil.getGroupIds(g);this.sGroupIds=this.filterGroupIds(c)}},filterGroupIds:function(c){var g;var C=c.split(",");var I=this.sGroupIds.split(",");for(var i=0;i<I.length;i++){if(C.indexOf(I[i])===-1){I.splice(i,1);i=i-1}}if(I.length!==0){g=I.join()}else{g=""}return g}});
