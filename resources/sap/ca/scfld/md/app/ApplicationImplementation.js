jQuery.sap.declare("sap.ca.scfld.md.app.ApplicationImplementation");jQuery.sap.require("sap.ca.scfld.md.app.ConnectionManager");jQuery.sap.require("sap.ca.scfld.md.app.MasterHeaderFooterHelper");jQuery.sap.require("sap.ca.scfld.md.app.DetailHeaderFooterHelper");jQuery.sap.require("sap.ca.scfld.md.app.FullScreenHeaderFooterHelper");sap.ui.base.ManagedObject.extend("sap.ca.scfld.md.app.ApplicationImplementation",{metadata:{properties:{identity:"string",component:"object",oViewHook:"string"},methods:["getConnectionManager"]},init:function(){},sI18N:"i18n",startApplication:function(c){this.oMHFHelper=new sap.ca.scfld.md.app.MasterHeaderFooterHelper(this);this.oDHFHelper=new sap.ca.scfld.md.app.DetailHeaderFooterHelper(this);this.oFHFHelper=new sap.ca.scfld.md.app.FullScreenHeaderFooterHelper(this);this.oConfiguration=c;this.aMasterKeys=c.getMasterKeyAttributes();this.aKeyValues=null;var l=sap.ui.getCore().getConfiguration().getFormatLocale();var b=this.getIdentity()+".i18n.i18n";this.AppI18nModel=new sap.ui.model.resource.ResourceModel({bundleName:b,bundleLocale:l});var C=this.getComponent();if(!sap.ui.getCore().getConfiguration().getDisableCustomizing()){var m=C.getMetadata();if(m){var e=m.getConfig("sap.ca.i18Nconfigs");if(e.bundleName){this.AppI18nModel.enhance(e)}}}this.UilibI18nModel=new sap.ui.model.resource.ResourceModel({bundleName:"sap.ca.scfld.md.i18n.i18n",bundleLocale:l});this.oConnectionManager=sap.ca.scfld.md.app.ConnectionManager.getNewInstance(this.getIdentity(),this.oConfiguration,{},this.getComponent());this.bIsPhone=jQuery.device.is.phone;var h=sap.ui.getCore().byId(this.getOViewHook());h.setModel(this.AppI18nModel,this.sI18N)},getResourceBundle:function(){return this.AppI18nModel.getResourceBundle()},getUiLibResourceBundle:function(){return this.UilibI18nModel.getResourceBundle()},getODataModel:function(n){if(n==this.sI18N){return this.AppI18nModel}return this.oConnectionManager.getModel(n)},setModels:function(c){var v=c.getView();v.setModel(this.AppI18nModel,this.sI18N);v.setModel(sap.ui.getCore().getModel("device"),"device");jQuery.each(this.oConnectionManager.modelList,function(n,m){if(n=="undefined"){v.setModel(m)}else{v.setModel(m,n)}})},isMock:function(){var r=jQuery.sap.getUriParameters().get("responderOn");return("true"===r)},getConnectionManager:function(){return this.oConnectionManager},onMasterRefreshed:function(c){this.setStoredSelectedItem(c)},onMasterChanged:function(c){this.oMHFHelper.defineMasterHeaderFooter(c)},setStoredSelectedItem:function(c){if(!this.aKeyValues){return}var l=c.getList();var I=l.getItems();if(I.length==0){return}l.removeSelections();for(var i=0;i<I.length;i++){var f=true;var L=I[i];if((L instanceof sap.m.GroupHeaderListItem)){continue}var o=L.getBindingContext(this.sModelName);for(var j=0;f&&j<this.aKeyValues.length;j++){f=this.aKeyValues[j]==o.getProperty(this.aMasterKeys[j])}if(f){if(this.bIsPhone){L.setSelected(true);l.setSelectedItem(L,true)}break}}if(!f){var L=I[0]}if(!this.bIsPhone){l.fireSelect({listItem:L})}return},defineDetailHeaderFooter:function(c){this.oDHFHelper.defineDetailHeaderFooter(c)},defineFullscreenHeaderFooter:function(c){this.oFHFHelper.defineHeaderFooter(c)},setSplitContainer:function(s){this.oSplitContainer=s},registerExitModule:function(e){if(!this.aExitModules){this.aExitModules=[];var c=this.getComponent();if(c.exit){var a=jQuery.proxy(c.exit,c)}else{var a=function(){}}c.exit=jQuery.proxy(function(){for(var i=0;i<this.aExitModules.length;i++){this.aExitModules[i]()}a()},this)}this.aExitModules.push(e)},setMasterListBinding:function(c,b){if(c._oMasterListBinding){c._oMasterListBinding.detachChange(c._onMasterListLoaded,c);c._oMasterListBinding.detachChange(c._onMasterListChanged,c)}c._oMasterListBinding=b;if(c._oMasterListBinding){c._oMasterListBinding.attachChange(c._onMasterListLoaded,c);c._oMasterListBinding.attachChange(c._onMasterListChanged,c)}}});
