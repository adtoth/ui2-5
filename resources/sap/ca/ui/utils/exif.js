jQuery.sap.declare("sap.ca.ui.utils.exif");sap.ui.base.Object.extend("sap.ca.ui.utils.exif",{});(function(){var d=false;sap.ca.ui.utils.exif.TiffTags={0x0100:"ImageWidth",0x0101:"ImageHeight",0x8769:"ExifIFDPointer",0x8825:"GPSInfoIFDPointer",0xA005:"InteroperabilityIFDPointer",0x0102:"BitsPerSample",0x0103:"Compression",0x0106:"PhotometricInterpretation",0x0112:"Orientation",0x0115:"SamplesPerPixel",0x011C:"PlanarConfiguration",0x0212:"YCbCrSubSampling",0x0213:"YCbCrPositioning",0x011A:"XResolution",0x011B:"YResolution",0x0128:"ResolutionUnit",0x0111:"StripOffsets",0x0116:"RowsPerStrip",0x0117:"StripByteCounts",0x0201:"JPEGInterchangeFormat",0x0202:"JPEGInterchangeFormatLength",0x012D:"TransferFunction",0x013E:"WhitePoint",0x013F:"PrimaryChromaticities",0x0211:"YCbCrCoefficients",0x0214:"ReferenceBlackWhite",0x0132:"DateTime",0x010E:"ImageDescription",0x010F:"Make",0x0110:"Model",0x0131:"Software",0x013B:"Artist",0x8298:"Copyright"};function f(F){var m=[];if(F.getByteAt(0)!=0xFF||F.getByteAt(1)!=0xD8){return false}var o=2;var l=F.getLength();while(o<l){if(F.getByteAt(o)!=0xFF){if(d)jQuery.sap.log.error("Not a valid marker at offset "+o+", found: "+F.getByteAt(o));return false}var M=F.getByteAt(o+1);if(M==22400){if(d)jQuery.sap.log.error("Found 0xFFE1 marker");return b(F,o+4,F.getShortAt(o+2,true)-2)}else if(M==225){if(d)jQuery.sap.log.error("Found 0xFFE1 marker");return b(F,o+4,F.getShortAt(o+2,true)-2)}else{o+=2+F.getShortAt(o+2,true)}}}function r(F,t,D,s,B){var e=F.getShortAt(D,B);var T={};for(var i=0;i<e;i++){var E=D+i*12+2;var c=s[F.getShortAt(E,B)];if(!c&&d)jQuery.sap.log.error("Unknown tag: "+F.getShortAt(E,B));T[c]=a(F,E,t,D,B)}return T}function a(F,e,t,D,B){var T=F.getShortAt(e+2,B);var N=F.getLongAt(e+4,B);var v=F.getLongAt(e+8,B)+t;switch(T){case 1:case 7:if(N==1){return F.getByteAt(e+8,B)}else{var V=N>4?v:(e+8);var c=[];for(var n=0;n<N;n++){c[n]=F.getByteAt(V+n)}return c}break;case 2:var s=N>4?v:(e+8);return F.getStringAt(s,N-1);break;case 3:if(N==1){return F.getShortAt(e+8,B)}else{var V=N>2?v:(e+8);var c=[];for(var n=0;n<N;n++){c[n]=F.getShortAt(V+2*n,B)}return c}break;case 4:if(N==1){return F.getLongAt(e+8,B)}else{var c=[];for(var n=0;n<N;n++){c[n]=F.getLongAt(v+4*n,B)}return c}break;case 5:if(N==1){return F.getLongAt(v,B)/F.getLongAt(v+4,B)}else{var c=[];for(var n=0;n<N;n++){c[n]=F.getLongAt(v+8*n,B)/F.getLongAt(v+4+8*n,B)}return c}break;case 9:if(N==1){return F.getSLongAt(e+8,B)}else{var c=[];for(var n=0;n<N;n++){c[n]=F.getSLongAt(v+4*n,B)}return c}break;case 10:if(N==1){return F.getSLongAt(v,B)/F.getSLongAt(v+4,B)}else{var c=[];for(var n=0;n<N;n++){c[n]=F.getSLongAt(v+8*n,B)/F.getSLongAt(v+4+8*n,B)}return c}break}}function b(F,s,l){if(F.getStringAt(s,4)!="Exif"){if(d)jQuery.sap.log.error("Not valid EXIF data! "+F.getStringAt(s,4));return false}var B;var t=s+6;if(F.getShortAt(t)==0x4949){B=false}else if(F.getShortAt(t)==0x4D4D){B=true}else{if(d)jQuery.sap.log.error("Not valid TIFF data! (no 0x4949 or 0x4D4D)");return false}if(F.getShortAt(t+2,B)!=0x002A){if(d)jQuery.sap.log.error("Not valid TIFF data! (no 0x002A)");return false}if(F.getLongAt(t+4,B)!=0x00000008){if(d)jQuery.sap.log.error("Not valid TIFF data! (First offset not 8)",F.getShortAt(t+4,B));return false}var T=r(F,t,t+8,sap.ca.ui.utils.exif.TiffTags,B);return T}sap.ca.ui.utils.exif.readFromBinary=function(F){return f(F)}})();
