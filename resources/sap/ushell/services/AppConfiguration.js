// Copyright (c) 2013 SAP AG, All Rights Reserved
(function(){"use strict";jQuery.sap.declare("sap.ushell.services.AppConfiguration");jQuery.sap.require("sap.ushell.ui.footerbar.SettingsButton");function A(){var m={},c=null;this.getMetadata=function(a){if(!a){a=c}if(a){var k=this.getApplicationUrl(a);if(!(m.hasOwnProperty(k))){this.addMetadata(a)}return m[k]||{}}return{}};this.setCurrentApplication=function(a){c=a};this.getSettingsControl=function(){return new sap.ushell.ui.footerbar.SettingsButton()};this.getApplicationName=function(a){var M,s=(a&&a.additionalInformation)||null;if(s){M=/^SAPUI5\.Component=(.+)$/i.exec(s);if(M){return M[1]}}return null};this.getApplicationUrl=function(a){var u=(a&&a.url)||null,i;if(u){i=u.indexOf("?");if(i>=0){u=u.slice(0,i)}if(u.slice(-1)!=='/'){u+='/'}}return u};this.addMetadata=function(a){try{var C=this.getApplicationName(a),u=this.getApplicationUrl(a),s,o,r,R,l,b,i,p,v,P=["libraryName","version","fullWidth","title","icon","favIcon","homeScreenIconPhone","homeScreenIconPhone@2","homeScreenIconTablet","homeScreenIconTablet@2","startupImage320x460","startupImage640x920","startupImage640x1096","startupImage768x1004","startupImage748x1024","startupImage1536x2008","startupImage1496x2048"],d,e,f;if(u&&!(m.hasOwnProperty(u))){m[u]={};o=sap.ui.component.load({url:u,name:C});l=o.getMetadata();if(l){b=l&&l.getConfig();if(b){R=b.resourceBundle||"";if(R){if(R.slice(0,1)!=='/'){R=u+R}r=jQuery.sap.resources({url:R,locale:sap.ui.getCore().getConfiguration().getLanguage()})}}for(i=0;i<P.length;i=i+1){p=P[i];if(r&&b.hasOwnProperty(p+"Resource")){v=r.getText(b[p+"Resource"])}else if(b.hasOwnProperty(p)){v=b[p]}else{v=l["_s"+p.substring(0,1).toUpperCase()+p.slice(1)]}m[u][p]=v}}d=["favIcon","homeScreenIconPhone","homeScreenIconPhone@2","homeScreenIconTablet","homeScreenIconTablet@2","startupImage320x460","startupImage640x920","startupImage640x1096","startupImage768x1004","startupImage748x1024","startupImage1536x2008","startupImage1496x2048"];e=(u&&u[u.length-1]==='/')?u.substring(0,u.length-1):u;f=function(u){if(u.match(/^https?:\/\/.*/)){return false}return u&&u[0]!=='/'};d.forEach(function(h){var O=m[u][h],F=null;if(O){F=f(O)?e+"/"+O:O}m[u][h]=F})}}catch(g){jQuery.sap.log.warning("Application configuration could not be parsed")}}}sap.ushell.services.AppConfiguration=new A()}());
